<%- include('header') %>

<div class="card">
    <h3>Üdvözlünk a kvízben, <%- user %>!</h3>

    <!-- Kérdés megjelenítése -->
    <div class="mt-4">
        <h4 id="question" class="p-4 rounded" style="background: rgba(255, 255, 255, 0.1); color: #ffffff;">
            A kérdés szövege itt fog megjelenni...
        </h4>
    </div>

    <!-- Új válasz beküldése -->
    <div class="row mt-4">
        <div class="form-floating col-12 pe-3 mb-3">
            <input type="text" class="form-control" id="newAnswer" placeholder="Írd be a válaszod!">
            <label for="newAnswer">Írd be a válaszod!</label>
        </div>
        <button class="btn" id="submitAnswerBtn" style="background: linear-gradient(90deg, #007bff, #0056b3); color: #ffffff;">Beküld</button>
    </div>

    <div class="mt-4 text-center">
        <a href="/" class="btn btn-danger" id="exitQuizBtn" style="padding: 10px 20px; font-weight: bold;">Kilépés a kvízből</a>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="../../assets/moment.js"></script>
<script>
    const socket = io();
    const newAnswerField = document.querySelector('#newAnswer');
    const submitAnswerBtn = document.querySelector('#submitAnswerBtn');
    const questionElement = document.querySelector('#question');

    // Kérdés fogadása
    socket.on('newQuestion', (questionText) => {
        displayQuestion(questionText);
    });

    // Válasz beküldése
    submitAnswerBtn.addEventListener('click', sendAnswer);
    newAnswerField.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
            sendAnswer();
        }
    });

    function sendAnswer() {
        const answer = newAnswerField.value.trim();
        if (answer !== '') {
            socket.emit('submitAnswer', answer);
            newAnswerField.value = '';
        } else {
            alert('Kérlek, írj be egy választ!');
        }
    }

    function displayQuestion(questionText) {
        questionElement.textContent = questionText;
        questionElement.classList.add('question-appear');
        setTimeout(() => {
            questionElement.classList.remove('question-appear');
        }, 800);
    }

    // Visszajelzés fogadása
    socket.on('answerFeedback', (feedback) => {
        alert(feedback);
    });
</script>

<%- include('footer') %>

<%- include('header') %>

<div class="d-flex" style="height: 50vh; gap: 30px;">
    <!-- Kvíz kártya -->
    <div class="card flex-grow-1" style="display: flex; flex-direction: column;">
        <h3>Üdvözlünk a kvízben!</h3>

        <!-- Kérdés megjelenítése -->
        <div class="mt-4">
            <h4 id="question" class="p-4 rounded" style="background: rgba(255, 255, 255, 0.1); color: #ffffff;">
                A kérdés szövege itt fog megjelenni...
            </h4>
        </div>

        <!-- Új válasz beküldése -->
        <div class="mt-4">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="newAnswer" placeholder="Írd be a válaszod!">
                <label for="newAnswer">Írd be a válaszod!</label>
            </div>
            <button class="btn w-100" id="submitAnswerBtn" style="background: linear-gradient(90deg, #007bff, #0056b3); color: #ffffff;">Beküld</button>
        </div>

        <div class="mt-auto text-center">
            <a href="/" class="btn btn-danger" id="exitQuizBtn" style="padding: 10px 20px; font-weight: bold;">Kilépés a kvízből</a>
        </div>
    </div>

    <!-- Játékosok panel -->
    <div class="players-panel">
        <h5>Játékosok</h5>
        <ul id="playerList">
            <!-- Dinamikusan generált játékos nevek -->
        </ul>
    </div>
    
</div>

<%- include('footer') %>

<script src="/socket.io/socket.io.js"></script>
<script src="../../assets/moment.js"></script>
<script>
    const socket = io();
    const newAnswerField = document.querySelector('#newAnswer');
    const submitAnswerBtn = document.querySelector('#submitAnswerBtn');
    const questionElement = document.querySelector('#question');

    // Kérdés fogadása
    socket.on('newQuestion', (questionText) => {
        displayQuestion(questionText);
    });

    // Válasz beküldése
    submitAnswerBtn.addEventListener('click', sendAnswer);
    newAnswerField.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
            sendAnswer();
        }
    });

    function sendAnswer() {
        const answer = newAnswerField.value.trim();
        if (answer !== '') {
            socket.emit('submitAnswer', answer);
            newAnswerField.value = '';
        } else {
            alert('Kérlek, írj be egy választ!');
        }
    }

    function displayQuestion(questionText) {
        questionElement.textContent = questionText;
        questionElement.classList.add('question-appear');
        setTimeout(() => {
            questionElement.classList.remove('question-appear');
        }, 800);
    }

    // Visszajelzés fogadása
    socket.on('answerFeedback', (feedback) => {
        alert(feedback);
    });
</script>


<script src="/socket.io/socket.io.js"></script>